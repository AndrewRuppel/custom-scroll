/*
 * jQuery Custom Scroll plugin
 * https://github.com/standys/custom-scroll
 *
 * Copyright 2014, Mostovoy Andrey
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(t){function o(o,r){function e(){var t=0|c.prop("scrollHeight"),e=o.innerHeight(),n=Math.max(e*e/t|0,r.barMinHeight),a=(e-n)/(t-e);return{ratio:a,height:e,heightTotal:t,barHeight:n}}function n(){var t=e();s&&s.height===t.height&&s.heightTotal===t.heightTotal||(d.toggleClass(i("hidden"),t.barHeight>=t.height),s=t);var o=c.scrollTop(),n=o*t.ratio;r.doWrap||(n+=o),0>n&&(n=0),r.doWrap&&n>t.height-t.barHeight&&(n=t.height-t.barHeight),d.height(t.barHeight).css("top",n)}function a(){u.remove(),o.removeClass(i("container")).removeData("custom-scroll"),r.doWrap?(c.contents().appendTo(o),c.remove()):o.removeClass(i("dont-wrap"))}function i(t){return r.prefix+t}r=t.extend({},t.fn.customScroll.defaultOptions,r);var s;if(o.hasClass(i("container"))){var l=o.data("custom-scroll");if(l)return l.updateBar(),l}if(r.predefined)c=o.children().first(),u=o.children().slice(1);else{if(o.addClass(i("container")),r.doWrap){o.wrapInner('<div class="'+i("inner")+'"></div>');var c=o.children()}else o.addClass(i("dont-wrap")),c=o;var h=null!=r.barHtml?r.barHtml:'<div class="'+i("bar")+" "+i("hidden")+'"></div>',u=t(h);o.append(u)}var d=u.last(),f=t("body");d.on("mousedown",function(t){var o=c.scrollTop(),r=t.clientY,n=e().ratio;f.on("mousemove.custom-scroll",function(t){t.stopPropagation(),t.preventDefault();var e=t.clientY-r,a=o+e/n;c.scrollTop(a)}),f.on("mouseup.custom-scroll",function(){f.off("mousemove.custom-scroll"),f.off("mouseup.custom-scroll")})}),c.on("scroll",n),n();var p={$container:o,$bar:d,$inner:c,destroy:a,updateBar:n};return o.data("custom-scroll",p),p}t.fn.customScroll=function(r){return"destroy"===r?(this.each(function(){var o=t(this).data("custom-scroll");o&&o.destroy()}),this):1===this.length?o(this,r):void this.each(function(){o(t(this),r)})},t.fn.customScroll.defaultOptions={prefix:"custom-scroll_",barMinHeight:10,barHtml:null,doWrap:!0,predefined:!1}}(jQuery);