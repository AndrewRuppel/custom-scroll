/*
 * jQuery Custom Scroll plugin
 * https://github.com/standys/custom-scroll
 *
 * Copyright 2014, Mostovoy Andrey
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(t){function o(o,r){function e(){var t=0|c.prop("scrollHeight"),e=o.innerHeight(),n=Math.max(e*e/t|0,r.barMinHeight),a=(e-n)/(t-e);return{ratio:a,height:e,heightTotal:t,barHeight:n}}function n(){var t=e(),o=t.barHeight>=t.height;o!==i&&(u.toggleClass(l+"hidden",o),i=o);var r=c.scrollTop(),n=r*t.ratio;0>n&&(n=0),n>t.height-t.barHeight&&(n=t.height-t.barHeight),u.height(t.barHeight).css("top",n)}function a(){u.remove(),o.removeClass(l+"container").removeData("custom-scroll"),c.contents().appendTo(o),c.remove()}r=t.extend({},t.fn.customScroll.defaultOptions,r);var i;if(o.hasClass(r.prefix+"container")){var s=o.data("custom-scroll");if(s)return s.updateBar(),s}var l=r.prefix;o.addClass(l+"container");var c=o.children("."+l+"inner");c.length||(c=o.wrapInner('<div class="'+l+'inner"></div>').children());var u=o.children("."+l+"bar");u.length||(u=t(r.barHtml).addClass(l+"bar").appendTo(o));var h=t("body");u.on("mousedown",function(t){var o=c.scrollTop(),r=t.clientY,n=e().ratio;h.on("mousemove.custom-scroll",function(t){t.stopPropagation(),t.preventDefault();var e=t.clientY-r,a=o+e/n;c.scrollTop(a)}),h.on("mouseup.custom-scroll",function(){h.off("mousemove.custom-scroll"),h.off("mouseup.custom-scroll")})}),c.on("scroll",n),n();var d={$container:o,$bar:u,$inner:c,destroy:a,updateBar:n};return o.data("custom-scroll",d),d}t.fn.customScroll=function(r){return"destroy"===r?(this.each(function(){var o=t(this).data("custom-scroll");o&&o.destroy()}),this):1===this.length?o(this,r):void this.each(function(){o(t(this),r)})},t.fn.customScroll.defaultOptions={prefix:"custom-scroll_",barMinHeight:10,barHtml:"<div />"}}(jQuery);