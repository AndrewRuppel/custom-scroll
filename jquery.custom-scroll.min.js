/*
 * jQuery Custom Scroll plugin
 * https://github.com/standys/custom-scroll
 *
 * Copyright 2014, Mostovoy Andrey
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(o){function t(t,r){function e(){var o=0|l.prop("scrollHeight"),e=t.innerHeight(),i=e-r.offsetTop-r.offsetBottom,n=Math.max(i*e/o|0,r.barMinHeight),s=(i-n)/(o-e);return{ratio:s,height:e,heightScroll:i,heightTotal:o,barHeight:n}}function i(){var o=e(),i=o.barHeight>=o.heightScroll;i!==a&&(t.toggleClass(r.prefix+"hidden",i),a=i);var n=l.scrollTop(),s=n*o.ratio;0>s&&(s=0),s>o.heightScroll-o.barHeight&&(s=o.heightScroll-o.barHeight),f.height(o.barHeight).css("top",r.offsetTop+s)}function n(){f.remove(),t.removeClass(r.prefix+"container").removeData("custom-scroll"),l.contents().appendTo(t),l.remove()}var s=t.data("custom-scroll");r=s?s.options:o.extend({},o.fn.customScroll.defaultOptions,r);var a;if(t.hasClass(r.prefix+"container")){var s=t.data("custom-scroll");if(s)return s.updateBar(),s}t.addClass(r.prefix+"container");var l=t.children("."+r.prefix+"inner");l.length||(l=t.wrapInner('<div class="'+r.prefix+'inner"></div>').children());var c=l[0].offsetWidth-l[0].clientWidth;l.css("marginRight",-c+"px");var f=t.children("."+r.prefix+"bar");f.length||(f=o(r.barHtml).addClass(r.prefix+"bar").appendTo(t));var h=o("body");f.on("mousedown",function(o){var t=l.scrollTop(),r=o.clientY,i=e().ratio;h.on("mousemove.custom-scroll",function(o){o.stopPropagation(),o.preventDefault();var e=o.clientY-r,n=t+e/i;l.scrollTop(n)}),h.on("mouseup.custom-scroll",function(){h.off("mousemove.custom-scroll"),h.off("mouseup.custom-scroll")})}),l.on("scroll",i),i();var u={$container:t,$bar:f,$inner:l,destroy:n,updateBar:i,options:r};return t.data("custom-scroll",u),u}o.fn.customScroll=function(r){return"destroy"===r?(this.each(function(){var t=o(this).data("custom-scroll");t&&t.destroy()}),this):1===this.length?t(this,r):void this.each(function(){t(o(this),r)})},o.fn.customScroll.defaultOptions={prefix:"custom-scroll_",barMinHeight:10,offsetTop:0,offsetBottom:0,barHtml:"<div />"}}(jQuery);